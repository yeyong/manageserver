<img id="img_hidden" style="position:absolute;top:-100000px;filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(sizingMethod='image');width:400;height:300"></img>

 <table id="tab1" cellspacing="0" cellpadding="0" width="450">
                                    <tbody>
                                        <tr>
                                            <td>
                                                <b>图片描述:</b>
                                            </td>
                                        </tr>                                        
                                        <tr>
                                            <td>
                                                <cc2:TextBox ID="imgDesc" runat="server" Width="300" Height="50" TextMode="MultiLine"
                                                    IsReplaceInvertedComma="false"></cc2:TextBox>
                                            </td>
                                            <td>
                                                <span id="td1">
                                                    <img src="../images/invalid.gif" width="100" height="75" id="view1"></span>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <b>选择图片:</b>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <input type="file" id="photo1" onchange="PhotoView(1)" size="50" name="photo1">
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                                
                                <script>
    function PhotoView(layer) {
        var file = $("photo" + layer).value;
        if (file != "") {
            var patn = /\.jpg$|\.jpeg$|\.gif$|\.png$/i;
            if (!patn.test(file)) {
                clearFileInput($("photo" + layer));
                alert("相册只允许jpg、jpeg、gif或png格式的图片!");
                return;
            }
            if (document.all) //IE执行
            {
                insertImage(layer);
            }
        }
        else {
            $("view" + layer).src = "../images/invalid.gif";

        }
    }
    
    function insertImage(id) {
        var localimgpreview = '';
        var path = $('photo' + id).value;
        var ext = path.lastIndexOf('.') == -1 ? '' : path.substr(path.lastIndexOf('.') + 1, path.length).toLowerCase();
        var re = new RegExp("(^|\\s|,)" + ext + "($|\\s|,)", "ig");
        var localfile = $('photo' + id).value.substr($('photo' + id).value.replace(/\\/g, '/').lastIndexOf('/') + 1);

        if (path == '') {
            return;
        }

        var err = false;
        $('img_hidden').alt = id;
        try {
            $('img_hidden').filters.item("DXImageTransform.Microsoft.AlphaImageLoader").sizingMethod = 'image';
        }
        catch (e){ err = true; }
        try {
            $('img_hidden').filters.item("DXImageTransform.Microsoft.AlphaImageLoader").src = $('photo' + id).value;
        }
        catch (e) {
            alert('无效的图片文件。');
            delAttach(id);

            err = true;

            return;
        }
        var wh = { 'w': $('img_hidden').offsetWidth, 'h': $('img_hidden').offsetHeight };
        if (wh['w'] > 100) {
            wh['h'] *= 100 / wh['w'];
            wh['w'] = 100;
        }
        if (wh['h'] > 100) {
            wh['w'] *= 100 / wh['h'];
            wh['h'] = 100;
        }
        $('img_hidden').style.width = wh['w'];
        $('img_hidden').style.height = wh['h'];
        try {
            $('img_hidden').filters.item("DXImageTransform.Microsoft.AlphaImageLoader").sizingMethod = 'scale';
        }
        catch (e) {
        }
        if (err == true) {
            $('img_hidden').src = $('photo' + id).value;
        }
        div = document.createElement('div');
        $('td' + id).removeChild($('td' + id).children(0));
        $('td' + id).appendChild(div);
        div.innerHTML = '<img style="filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(sizingMethod=\'scale\',src=\'' + $('photo' + id).value + '\');width:' + wh['w'] + ';height:' + wh['h'] + '" src=\'../images/none.gif\' border="0" id="view' + id + '" aid="view' + id + '" alt="" />';
    }
    
    function clearFileInput(file) {
        var form = document.createElement('form');
        document.body.appendChild(form);
        var pos = file.nextSibling;
        form.appendChild(file);
        form.reset();
        pos.parentNode.insertBefore(file, pos);
        document.body.removeChild(form);
    }
</script>